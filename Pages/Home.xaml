<UserControl x:Class="OMPS.Pages.Home"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:OMPS"
             xmlns:Components="clr-namespace:OMPS.Components" xmlns:pages="clr-namespace:OMPS.Pages"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes" xmlns:sys="clr-namespace:System;assembly=System.Runtime" d:DataContext="{d:DesignInstance Type=pages:Home}"
             x:Name="Page_Home" VirtualizingPanel.IsVirtualizing="True" VirtualizingPanel.VirtualizationMode="Recycling"
             mc:Ignorable="d" 
             d:DesignHeight="1000" d:DesignWidth="1525"
             DataContext="{Binding ElementName=Page_Home}"
             FontSize="{Binding DataGridFontSize, RelativeSource={RelativeSource AncestorType=UserControl}, FallbackValue=12}">
    <UserControl.Resources>
        <!-- Context Menu fallback for DataGrids -->
        <ContextMenu x:Name="CtxMnu_EngRightClick" x:Key="CtxMnu_EngRightClick">
            <MenuItem Header="Actions for selected item" IsEnabled="False"/>
            <MenuItem x:Name="Ctx_Job_OpenInApp" Click="Ctx_Job_OpenInApp_Click">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="OpenInApp" Padding="1" Margin="0 0 4 0"/>
                        <TextBlock Text="Open in OrderLines"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>
            <MenuItem x:Name="Ctx_Job_OpenFolderInExplorer" Click="Ctx_Job_OpenFolderInExplorer_Click">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="ExternalLink" Padding="1" Margin="0 0 4 0"/>
                        <TextBlock Text="Open with Explorer"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>
            <MenuItem x:Name="Ctx_Job_OpenContainingFolderInExplorer" Click="Ctx_Job_OpenContainingFolderInExplorer_Click">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="FolderArrowUp" Padding="1" Margin="0 0 4 0"/>
                        <TextBlock Text="Open Conntaining Folder"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>
        </ContextMenu>

        <!-- Quick Preview Section Header -->
        <ControlTemplate x:Key="QuickPreview_Section_HeaderTemplate" TargetType="ContentControl">
            <Border BorderThickness="0 0 0 2" CornerRadius="1" x:Name="MainBorder" HorizontalAlignment="Stretch" VerticalAlignment="Stretch" Padding="4">
                <Border.Background>
                    <SolidColorBrush Color="#353535" Opacity="1.0"/>
                </Border.Background>
                <Border.BorderBrush>
                    <SolidColorBrush Color="{Binding BorderBrush.Color, RelativeSource={RelativeSource TemplatedParent}}" Opacity="1.0"/>
                </Border.BorderBrush>
                <TextBlock VerticalAlignment="Center" HorizontalAlignment="Stretch" Margin="12 0 0 0"
                               Foreground="#FFEFEFEF" FontWeight="Bold" FontSize="22"
                               Text="{Binding Tag, RelativeSource={RelativeSource AncestorType=ContentControl}}">
                    <TextBlock.Effect>
                        <DropShadowEffect BlurRadius="6" Color="#000" Direction="-45" Opacity="0.3" ShadowDepth="3" />
                    </TextBlock.Effect>
                </TextBlock>
            </Border>
        </ControlTemplate>

        <!-- Quick Preview Tile Header -->
        <ControlTemplate x:Key="QuickPreview_Tile_HeaderTemplate" TargetType="ContentControl">
            <Border CornerRadius="1" BorderThickness="1" x:Name="MainBorder" Margin="0 0 0 8">
                <Border.Background>
                    <LinearGradientBrush EndPoint="4,6" StartPoint="0,0" SpreadMethod="Repeat" MappingMode="Absolute" Opacity="0.267">
                        <GradientStop Color="{Binding Background.Color, RelativeSource={RelativeSource TemplatedParent}}"/>
                        <GradientStop Color="#0000" Offset="1"/>
                    </LinearGradientBrush>
                </Border.Background>
                <Border.BorderBrush>
                    <SolidColorBrush Color="{Binding Background.Color, RelativeSource={RelativeSource TemplatedParent}}" Opacity="0.267"/>
                </Border.BorderBrush>
                <StackPanel HorizontalAlignment="Stretch" VerticalAlignment="Stretch">
                    <StackPanel.Effect>
                        <DropShadowEffect BlurRadius="6" Color="#000" Direction="-45" Opacity="0.5" ShadowDepth="3" />
                    </StackPanel.Effect>
                    <ContentPresenter VerticalAlignment="Top" HorizontalAlignment="Stretch" Margin="4 2">
                        <ContentPresenter.Effect>
                            <DropShadowEffect BlurRadius="12" Color="{Binding Background.Color, RelativeSource={RelativeSource TemplatedParent}}" Direction="-45" Opacity="0.7" ShadowDepth="0" />
                        </ContentPresenter.Effect>
                    </ContentPresenter>
                    <Rectangle Height="0">
                        <Rectangle.Fill>
                            <SolidColorBrush Color="{Binding Background.Color, RelativeSource={RelativeSource TemplatedParent}}" Opacity="1.0"/>
                        </Rectangle.Fill>
                        <Rectangle.OpacityMask>
                            <LinearGradientBrush EndPoint="1,0.5" StartPoint="0,0.5">
                                <GradientStop Color="Black"/>
                                <GradientStop Color="Transparent" Offset="5"/>
                            </LinearGradientBrush>
                        </Rectangle.OpacityMask>
                    </Rectangle>
                </StackPanel>
            </Border>

        </ControlTemplate>

        <!-- Style for Row quick access button -->
        <Style x:Key="QuickActionButton" TargetType="{x:Type Button}" BasedOn="{StaticResource MaterialDesignFlatButton}">
            <Setter Property="Foreground" Value="#ccc"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Margin" Value="2 0"/>
            <Setter Property="Padding" Value="1"/>
            <Setter Property="materialDesign:ButtonAssist.CornerRadius" Value="20"/>
            <Setter Property="Height" Value="{Binding ElementName=Page_Home, Path=MainViewModel.FontSize_H2_2}"/>
            <Setter Property="Width" Value="{Binding ElementName=Page_Home, Path=MainViewModel.FontSize_H2_2}"/>
        </Style>
        
        <!-- Style for Row quick access button icon -->
        <Style x:Key="QuickActionButton_Icon" TargetType="materialDesign:PackIcon">
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="Height" Value="{Binding ElementName=Page_Home, Path=MainViewModel.FontSize_H3, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"/>
            <Setter Property="Width" Value="{Binding ElementName=Page_Home, Path=MainViewModel.FontSize_H3, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"/>
        </Style>

        <!-- Style for DataGrid Row -->
        <Style x:Key="DataGrid_QuickAction_RowStyle" TargetType="DataGridRow" BasedOn="{StaticResource {x:Type DataGridRow}}">
            <Setter Property="Height" Value="{Binding ElementName=Page_Home, Path=MainViewModel.FontSize_H2, Mode=OneWay, UpdateSourceTrigger=PropertyChanged}"/>
            <Setter Property="ContextMenu" Value="{StaticResource CtxMnu_EngRightClick}"/>
            <Setter Property="Padding" Value="0 1"/>
        </Style>

        <!-- Style for DataGrid Cell -->
        <Style x:Key="DataGrid_QuickAction_CellStyle" TargetType="DataGridCell" BasedOn="{StaticResource {x:Type DataGridCell}}">
            <Setter Property="Padding" Value="16 0"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="FontSize" Value="{Binding MainViewModel.FontSize_H4, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, FallbackValue=12}"/>
            <Style.Triggers>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="BorderThickness" Value="0"/>
                </Trigger>
            </Style.Triggers>
        </Style>

        <!-- Style for StackPanel's Hover Visibility -->
        <Style x:Key="EngChecksHoverStackPanelStyle" TargetType="StackPanel">
            <Setter Property="Visibility" Value="Visible"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="RenderTransformOrigin" Value="0,0.5"/>
            <Setter Property="Opacity" Value="0"/>

            <Style.Triggers>
                <DataTrigger Binding="{Binding RelativeSource={RelativeSource AncestorType={x:Type DataGridRow}}, Path=IsMouseOver}" Value="True">
                    <DataTrigger.EnterActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                         From="0" To="1"
                                         Duration="0:0:0.2"
                                         FillBehavior="HoldEnd"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </DataTrigger.EnterActions>
                    <DataTrigger.ExitActions>
                        <BeginStoryboard>
                            <Storyboard>
                                <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                         From="1" To="0"
                                         Duration="0:0:0.2"
                                         FillBehavior="HoldEnd"/>
                            </Storyboard>
                        </BeginStoryboard>
                    </DataTrigger.ExitActions>
                </DataTrigger>
            </Style.Triggers>
        </Style>

        <!-- DataTemplate for Column with Name and Buttons -->
        <DataTemplate x:Key="NameColumnDataTemplate">
            <StackPanel Orientation="Horizontal" Margin="0 1" HorizontalAlignment="Stretch">
                
                <TextBlock Text="{Binding Name}"  Cursor="Hand" Background="Transparent"
                           VerticalAlignment="Center" TextAlignment="Left" HorizontalAlignment="Left"
                           FontSize="{Binding MainViewModel.FontSize_H4, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, FallbackValue=12}"/>

                <StackPanel Orientation="Horizontal" Style="{StaticResource EngChecksHoverStackPanelStyle}" HorizontalAlignment="Center" Margin="12 0 0 0">

                    <Button Style="{StaticResource QuickActionButton}" Click="Ctx_Job_OpenInApp_Click">
                        <materialDesign:PackIcon Style="{StaticResource QuickActionButton_Icon}" Kind="OpenInApp" ToolTip="Open on EngOrder"/>
                    </Button>

                    <Button Style="{StaticResource QuickActionButton}" Click="Ctx_Job_OpenFolderInExplorer_Click">
                        <materialDesign:PackIcon Style="{StaticResource QuickActionButton_Icon}" Kind="ExternalLink" ToolTip="Open in Explorer"/>
                    </Button>

                    <Button Style="{StaticResource QuickActionButton}" Click="Ctx_Job_OpenContainingFolderInExplorer_Click">
                        <materialDesign:PackIcon Style="{StaticResource QuickActionButton_Icon}" Kind="FolderArrowUp" ToolTip="Open Containing Folder"/>
                    </Button>
                </StackPanel>
            </StackPanel>
        </DataTemplate>

        <!-- DataTemplate for Column with JobNbr and Buttons -->
        <DataTemplate x:Key="JobNbrColumnDataTemplate">
            <StackPanel Orientation="Vertical" Margin="0 1">
                <TextBlock Text="{Binding JobNbr}"  Cursor="Hand" Background="Transparent"
                           VerticalAlignment="Center" TextAlignment="Center" HorizontalAlignment="Center"
                           FontSize="{Binding MainViewModel.FontSize_H4, RelativeSource={RelativeSource AncestorType={x:Type UserControl}}, FallbackValue=12}"/>
                <StackPanel Orientation="Horizontal" Margin="0" Style="{StaticResource EngChecksHoverStackPanelStyle}">

                    <Button Style="{StaticResource QuickActionButton}" Click="Ctx_Job_OpenInApp_Click">
                        <materialDesign:PackIcon Style="{StaticResource QuickActionButton_Icon}" Kind="OpenInApp" ToolTip="Open on EngOrder"/>
                    </Button>

                    <Button Style="{StaticResource QuickActionButton}" Click="Ctx_Job_OpenFolderInExplorer_Click">
                        <materialDesign:PackIcon Style="{StaticResource QuickActionButton_Icon}" Kind="ExternalLink" ToolTip="Open in Explorer"/>
                    </Button>

                    <Button Style="{StaticResource QuickActionButton}" Click="Ctx_Job_OpenContainingFolderInExplorer_Click">
                        <materialDesign:PackIcon Style="{StaticResource QuickActionButton_Icon}" Kind="FolderArrowUp" ToolTip="Open Containing Folder"/>
                    </Button>
                </StackPanel>
            </StackPanel>
        </DataTemplate>

        <!-- Style for DataGrid overall -->
        <Style x:Key="DataGrid_QuickAction_Style" TargetType="DataGrid" BasedOn="{StaticResource {x:Type DataGrid}}">
            <Setter Property="RowStyle" Value="{StaticResource DataGrid_QuickAction_RowStyle}"/>
            <Setter Property="CellStyle" Value="{StaticResource DataGrid_QuickAction_CellStyle}"/>
            <Setter Property="Foreground" Value="#ccc"/>
            <Setter Property="FontSize" Value="{Binding MainViewModel.FontSize_H4}"/>
            <Setter Property="AutoGenerateColumns" Value="False"/>
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="HeadersVisibility" Value="Column"/>
            <Setter Property="SelectionMode" Value="Single"/>
            <Setter Property="SnapsToDevicePixels" Value="False"/>
            <Setter Property="CanUserResizeRows" Value="False"/>
            <Setter Property="GridLinesVisibility" Value="None"/>
            <Setter Property="IsReadOnly" Value="True"/>
        </Style>
        
    </UserControl.Resources>
    
    <UserControl.Background>
        <LinearGradientBrush EndPoint="0,0" StartPoint="1,1">
            <GradientStop Color="#FF292929" Offset="1"/>
            <GradientStop Color="#FF111111" Offset="0"/>
        </LinearGradientBrush>
    </UserControl.Background>
    
    <UserControl.CacheMode>
        <BitmapCache EnableClearType="True" RenderAtScale="2.0" SnapsToDevicePixels="True"/>
    </UserControl.CacheMode>
    
    <ScrollViewer DataContext="{Binding ElementName=Page_Home}">
        <StackPanel Orientation="Vertical" >
            <StackPanel.Background>
                <LinearGradientBrush EndPoint="1,1" StartPoint="0,0">
                    <GradientStop Color="#FF1F1F1F"/>
                </LinearGradientBrush>
            </StackPanel.Background>
            <StackPanel Margin="12 0" Background="Transparent">
                <ContentControl Template="{StaticResource QuickPreview_Section_HeaderTemplate}" Tag="Orders" BorderBrush="#FF70FF6C"/>

                <WrapPanel Orientation="Horizontal" Height="260" Margin="4">
                    <Border MinWidth="340" Width="Auto" Height="244"
                            BorderBrush="#FF70FF6C" Background="#1F1F1F" BorderThickness="0"
                            Margin="8" Padding="6 4" CornerRadius="1">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="18" Color="#000" Direction="-90" Opacity="0.3" ShadowDepth="4" />
                        </Border.Effect>
                        <materialDesign:ColorZone Foreground="#f0e9e5" Background="Transparent" FontFamily="Lucida Sans Typewriter" VerticalAlignment="Stretch">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <ContentControl Grid.Row="0" Template="{StaticResource QuickPreview_Tile_HeaderTemplate}" Background="#70FF6C">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="NewReleases" Margin="0 0 4 0" VerticalAlignment="Center"/>
                                        <TextBlock Text="New" FontSize="{Binding MainViewModel.FontSize_H3, FallbackValue=22}"
                                                       FontWeight="Bold" Foreground="#e9e9e5"/>
                                    </StackPanel>
                                    <ContentControl.Effect>
                                        <DropShadowEffect BlurRadius="0" Color="#000" Direction="-45" Opacity="0.5" ShadowDepth="2" />
                                    </ContentControl.Effect>
                                </ContentControl>

                                <DataGrid x:Name="DataGrid_NewOrders" Grid.Row="1" Style="{StaticResource DataGrid_QuickAction_Style}"
                                          DataContext="{Binding ElementName=Page_Home}" AutoGenerateColumns="True"
                                          ItemsSource="{Binding NewOrders, UpdateSourceTrigger=PropertyChanged}" LostFocus="DataGrid_LostFocus"
                                          CellStyle="{StaticResource DataGrid_QuickAction_CellStyle}"
                                          RowStyle="{StaticResource DataGrid_QuickAction_RowStyle}">
                                </DataGrid>

                            </Grid>
                        </materialDesign:ColorZone>
                    </Border>
                </WrapPanel>
            </StackPanel>

            <StackPanel Margin="12 0" Background="Transparent">
                <ContentControl Template="{StaticResource QuickPreview_Section_HeaderTemplate}" Tag="Engineering" BorderBrush="#FF6CB8FF"/>
                <ScrollViewer VerticalScrollBarVisibility="Hidden" HorizontalScrollBarVisibility="Visible" BorderBrush="#353535" BorderThickness="2">
                    <StackPanel Orientation="Horizontal" Height="260" Margin="4">
                        <Border MinWidth="340" Width="Auto" Height="244"
                            BorderBrush="#FF6CB8FF" Background="#1F1F1F" BorderThickness="0"
                            Margin="8" Padding="6 4" CornerRadius="1">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="18" Color="#000" Direction="-90" Opacity="0.3" ShadowDepth="4" />
                            </Border.Effect>
                            <materialDesign:ColorZone Foreground="#f0e9e5" Background="Transparent" FontFamily="Lucida Sans Typewriter" VerticalAlignment="Stretch">
                                <Grid LostFocus="DataGrid_LostFocus">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <ContentControl Grid.Row="0" Template="{StaticResource QuickPreview_Tile_HeaderTemplate}" Background="#6C89FF">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="Wrench" Margin="0 0 4 0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Working" FontSize="{Binding MainViewModel.FontSize_H3, FallbackValue=22}"
                                                       FontWeight="Bold" Foreground="#e9e9e5"/>
                                        </StackPanel>
                                    </ContentControl>

                                    <DataGrid x:Name="DataGrid_EngFolders" Style="{StaticResource DataGrid_QuickAction_Style}" Grid.Row="1"
                                              DataContext="{Binding ElementName=Page_Home}" AutoGenerateColumns="True"
                                              ItemsSource="{Binding EngWorking, UpdateSourceTrigger=PropertyChanged}" LostFocus="DataGrid_LostFocus"
                                              RowStyle="{StaticResource DataGrid_QuickAction_RowStyle}"
                                              CellStyle="{StaticResource DataGrid_QuickAction_CellStyle}">
                                    </DataGrid>
                                </Grid>
                            </materialDesign:ColorZone>
                        </Border>
                        <Border MinWidth="220" Width="Auto" Height="244"
                            BorderBrush="#FF6CB8FF" Background="#1F1F1F" BorderThickness="0"
                            Margin="8" Padding="6 4" CornerRadius="1">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="18" Color="#000" Direction="-90" Opacity="0.3" ShadowDepth="4" />
                            </Border.Effect>
                            <materialDesign:ColorZone Foreground="#f0e9e5" Background="Transparent" FontFamily="Lucida Sans Typewriter" VerticalAlignment="Stretch">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <ContentControl Grid.Row="0" Template="{StaticResource QuickPreview_Tile_HeaderTemplate}" Background="#6C89FF">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="FormatListChecks" Margin="0 0 4 0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Checking 1" FontSize="{Binding MainViewModel.FontSize_H3, FallbackValue=22}"
                                                       FontWeight="Bold" Foreground="#e9e9e5"/>
                                        </StackPanel>
                                    </ContentControl>
                                    <DataGrid x:Name="DataGrid_EngChecks1" Style="{StaticResource DataGrid_QuickAction_Style}" Grid.Row="1"
                                              DataContext="{Binding ElementName=Page_Home}"
                                              ItemsSource="{Binding EngCheck1, UpdateSourceTrigger=PropertyChanged}" LostFocus="DataGrid_LostFocus"
                                              RowStyle="{StaticResource DataGrid_QuickAction_RowStyle}"
                                              CellStyle="{StaticResource DataGrid_QuickAction_CellStyle}">
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Header="JobNbr" DisplayIndex="0" CellTemplate="{StaticResource NameColumnDataTemplate}"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </materialDesign:ColorZone>
                        </Border>
                        <Border MinWidth="220" Width="Auto" Height="244"
                            BorderBrush="#FF6CB8FF" Background="#1F1F1F" BorderThickness="0"
                            Margin="8" Padding="6 4" CornerRadius="1">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="18" Color="#000" Direction="-90" Opacity="0.3" ShadowDepth="4" />
                            </Border.Effect>
                            <materialDesign:ColorZone Foreground="#f0e9e5" Background="Transparent" FontFamily="Lucida Sans Typewriter" VerticalAlignment="Stretch">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <ContentControl Grid.Row="0" Template="{StaticResource QuickPreview_Tile_HeaderTemplate}" Background="#6C89FF">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="FormatListChecks" Margin="0 0 4 0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Checking 2" FontSize="{Binding MainViewModel.FontSize_H3, FallbackValue=22}"
                                                       FontWeight="Bold" Foreground="#e9e9e5"/>
                                        </StackPanel>
                                    </ContentControl>
                                    <DataGrid x:Name="DataGrid_EngChecks2" Style="{StaticResource DataGrid_QuickAction_Style}" Grid.Row="1"
                                              DataContext="{Binding ElementName=Page_Home}"
                                              ItemsSource="{Binding EngCheck2, UpdateSourceTrigger=PropertyChanged}" LostFocus="DataGrid_LostFocus"
                                              RowStyle="{StaticResource DataGrid_QuickAction_RowStyle}"
                                              CellStyle="{StaticResource DataGrid_QuickAction_CellStyle}">
                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Header="JobNbr" DisplayIndex="0" CellTemplate="{StaticResource NameColumnDataTemplate}"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </materialDesign:ColorZone>
                        </Border>
                        <Border MinWidth="340" Width="Auto" Height="244"
                                BorderBrush="#FF6CB8FF" Background="#1F1F1F" BorderThickness="0"
                                Margin="8" Padding="6 4" CornerRadius="1">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="18" Color="#000" Direction="-90" Opacity="0.3" ShadowDepth="4" />
                            </Border.Effect>
                            <materialDesign:ColorZone Foreground="#f0e9e5" Background="Transparent" FontFamily="Lucida Sans Typewriter" VerticalAlignment="Stretch">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <ContentControl Grid.Row="0" Template="{StaticResource QuickPreview_Tile_HeaderTemplate}" Background="#6C89FF">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="TaskAuto" Margin="0 0 4 0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Releasing" FontSize="{Binding MainViewModel.FontSize_H3, FallbackValue=22}"
                                                       FontWeight="Bold" Foreground="#e9e9e5"/>
                                        </StackPanel>
                                    </ContentControl>
                                    <DataGrid x:Name="DataGrid_EngRelease" Style="{StaticResource DataGrid_QuickAction_Style}" Grid.Row="1"
                                              DataContext="{Binding ElementName=Page_Home}"
                                              ItemsSource="{Binding EngReleases, UpdateSourceTrigger=PropertyChanged}" LostFocus="DataGrid_LostFocus"
                                              RowStyle="{StaticResource DataGrid_QuickAction_RowStyle}"
                                              CellStyle="{StaticResource DataGrid_QuickAction_CellStyle}">

                                        <DataGrid.Columns>
                                            <DataGridTemplateColumn Header="Parent" DisplayIndex="0">
                                                <DataGridTemplateColumn.CellTemplate>
                                                    <DataTemplate>
                                                        <StackPanel Orientation="Horizontal" Margin="0 1">
                                                            <TextBlock Text="{Binding Parent}"  Cursor="Hand" Background="Transparent"
                                                                       VerticalAlignment="Center" TextAlignment="Center" HorizontalAlignment="Center"
                                                                       FontSize="{Binding ElementName=Page_Home, Path=MainViewModel.FontSize_H4}"/>
                                                        </StackPanel>
                                                    </DataTemplate>
                                                </DataGridTemplateColumn.CellTemplate>
                                            </DataGridTemplateColumn>
                                            <DataGridTemplateColumn Header="JobNbr" DisplayIndex="1" CellTemplate="{StaticResource NameColumnDataTemplate}"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </Grid>
                            </materialDesign:ColorZone>
                        </Border>
                        <Border MinWidth="340" Width="Auto" Height="244"
                            BorderBrush="#FF6CB8FF" Background="#1F1F1F" BorderThickness="0"
                            Margin="8" Padding="6 4" CornerRadius="1">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="18" Color="#000" Direction="-90" Opacity="0.3" ShadowDepth="4" />
                            </Border.Effect>
                            <materialDesign:ColorZone Foreground="#f0e9e5" Background="Transparent" FontFamily="Lucida Sans Typewriter" VerticalAlignment="Stretch">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <ContentControl Grid.Row="0" Template="{StaticResource QuickPreview_Tile_HeaderTemplate}" Background="#6C89FF">
                                        <StackPanel Orientation="Horizontal">
                                            <materialDesign:PackIcon Kind="ZipBoxOutline" Margin="0 0 4 0" VerticalAlignment="Center"/>
                                            <TextBlock Text="Archive" FontSize="{Binding MainViewModel.FontSize_H3, FallbackValue=22}"
                                                       FontWeight="Bold" Foreground="#e9e9e5"/>
                                        </StackPanel>
                                    </ContentControl>
                                    <DataGrid x:Name="DataGrid_EngArchive" Style="{StaticResource DataGrid_QuickAction_Style}" Grid.Row="1"
                                              DataContext="{Binding ElementName=Page_Home}" AutoGenerateColumns="True" IsTextSearchEnabled="True"
                                              ItemsSource="{Binding EngArchive, UpdateSourceTrigger=PropertyChanged}" LostFocus="DataGrid_LostFocus"
                                              PreviewKeyDown="DataGrid_EngArchive_PreviewKeyDown"
                                              MouseDoubleClick="DataGrid_EngArchive_MouseDoubleClick"
                                              RowStyle="{StaticResource DataGrid_QuickAction_RowStyle}"
                                              CellStyle="{StaticResource DataGrid_QuickAction_CellStyle}">
                                    </DataGrid>
                                </Grid>
                            </materialDesign:ColorZone>
                        </Border>
                    </StackPanel>
                </ScrollViewer>
            </StackPanel>

            <StackPanel Margin="12 0" Background="Transparent">
                <ContentControl Template="{StaticResource QuickPreview_Section_HeaderTemplate}" Tag="CNC" BorderBrush="#FFFFC46C"/>
                <WrapPanel Orientation="Horizontal" Height="260" Margin="4">
                    <Border MinWidth="340" Width="Auto" Height="244"
                            BorderBrush="#FF6CB8FF" Background="#1F1F1F" BorderThickness="0"
                            Margin="8" Padding="6 4" CornerRadius="1">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="18" Color="#000" Direction="-90" Opacity="0.3" ShadowDepth="4" />
                        </Border.Effect>
                        <materialDesign:ColorZone Foreground="#f0e9e5" Background="Transparent" FontFamily="Lucida Sans Typewriter" VerticalAlignment="Stretch">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>

                                <ContentControl Grid.Row="0" Template="{StaticResource QuickPreview_Tile_HeaderTemplate}" Background="#FFC46C">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="SawBlade" Margin="0 0 4 0" VerticalAlignment="Center"/>
                                        <TextBlock Text="Wks Working" FontSize="{Binding MainViewModel.FontSize_H3, FallbackValue=22}"
                                                       FontWeight="Bold" Foreground="#e9e9e5"/>
                                    </StackPanel>
                                </ContentControl>

                                <DataGrid x:Name="DataGrid_CncWorkingWks" Style="{StaticResource DataGrid_QuickAction_Style}" Grid.Row="1"
                                              DataContext="{Binding ElementName=Page_Home}" AutoGenerateColumns="True"
                                              ItemsSource="{Binding CncWksEntries, UpdateSourceTrigger=PropertyChanged}"
                                              RowStyle="{StaticResource DataGrid_QuickAction_RowStyle}"
                                              CellStyle="{StaticResource DataGrid_QuickAction_CellStyle}">
                                </DataGrid>
                            </Grid>
                        </materialDesign:ColorZone>
                    </Border>
                    <Border MinWidth="340" Width="Auto" Height="244"
                            BorderBrush="#FF6CB8FF" Background="#1F1F1F" BorderThickness="0"
                            Margin="8" Padding="6 4" CornerRadius="1">
                        <Border.Effect>
                            <DropShadowEffect BlurRadius="18" Color="#000" Direction="-90" Opacity="0.3" ShadowDepth="4" />
                        </Border.Effect>
                        <materialDesign:ColorZone Foreground="#f0e9e5" Background="Transparent" FontFamily="Lucida Sans Typewriter" VerticalAlignment="Stretch">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <ContentControl Grid.Row="0" Template="{StaticResource QuickPreview_Tile_HeaderTemplate}" Background="#FFC46C">
                                    <StackPanel Orientation="Horizontal">
                                        <materialDesign:PackIcon Kind="SawBlade" Margin="0 0 4 0" VerticalAlignment="Center"/>
                                        <TextBlock Text="Pnl Working" FontSize="{Binding MainViewModel.FontSize_H3, FallbackValue=22}"
                                                       FontWeight="Bold" Foreground="#e9e9e5"/>
                                    </StackPanel>
                                </ContentControl>
                                <DataGrid x:Name="DataGrid_CncWorkingPnl" Style="{StaticResource DataGrid_QuickAction_Style}" Grid.Row="1"
                                              DataContext="{Binding ElementName=Page_Home}" AutoGenerateColumns="True"
                                              ItemsSource="{Binding CncPnlEntries, UpdateSourceTrigger=PropertyChanged}"
                                              RowStyle="{StaticResource DataGrid_QuickAction_RowStyle}"
                                              CellStyle="{StaticResource DataGrid_QuickAction_CellStyle}">
                                </DataGrid>
                            </Grid>
                        </materialDesign:ColorZone>
                    </Border>
                </WrapPanel>
            </StackPanel>
        </StackPanel>
    </ScrollViewer>
    
</UserControl>
